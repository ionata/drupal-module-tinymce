tinyMCE.importPluginLanguagePack("drupalbreak","en");var TinyMCE_drupalbreakPlugin={getInfo:function(){return {longname:"Drupal Teaser/Body Break",author:"Nathan Haug",authorurl:"http://www.quicksketch.org",infourl:"",version:"1.2"};},initInstance:function(_1){tinyMCE.importCSS(_1.getDoc(),tinyMCE.baseURL+"/plugins/drupalbreak/drupalbreak.css");},getControlHTML:function(_2){switch(_2){case "drupalbreak":return tinyMCE.getButtonHTML(_2,"lang_drupalbreak_desc","{$pluginurl}/images/drupalbreak.gif","mcedrupalbreak",false,"null");case "drupalpagebreak":var _3="tinyMCE.execInstanceCommand('{$editor_id}','mcedrupalpagebreak',true);return false;";return "<a href=\"javascript:"+_3+"\" onclick=\""+_3+"\" target=\"_self\" onmousedown=\"return false;\"><img id=\"{$editor_id}_drupalpagebreak\" src=\"{$pluginurl}/images/drupalpagebreak.gif\" title=\"{$lang_drupalpagebreak_desc}\" width=\"20\" height=\"20\" class=\"mceButtonNormal\" onmouseover=\"tinyMCE.switchClass(this,'mceButtonOver');\" onmouseout=\"tinyMCE.restoreClass(this);\" onmousedown=\"tinyMCE.restoreAndSwitchClass(this,'mceButtonDown');\" /></a>";}return "";},parseAttributes:function(_4){var _5="";var _6="";var _7;var _8;var _9=new Array();var _a=new RegExp("^[ \n\r\t]+","g");if(_4==null||_4.length<2){return null;}_7=_8=false;for(var i=0;i<_4.length;i++){var _c=_4.charAt(i);if((_c=="\""||_c=="'")&&!_8){_8=true;}else{if((_c=="\""||_c=="'")&&_8){_8=false;var _d=_5.lastIndexOf(" ");if(_d!=-1){_5=_5.substring(_d+1);}_9[_5.toLowerCase()]=_6.substring(1).toLowerCase();_5="";_6="";}else{if(!_a.test(_c)&&!_7&&!_8){_7=true;}}}if(_c=="="&&_7){_7=false;}if(_7){_5+=_c;}if(_8){_6+=_c;}}return _9;},execCommand:function(_e,_f,_10,_11,_12){function getAttrib(elm,_14){return elm.getAttribute(_14)?elm.getAttribute(_14):"";}switch(_10){case "mcedrupalbreak":var _15="";var _16=new Array();var _17=tinyMCE.getInstanceById(_e);var _18=_17.getFocusElement();if(_18!=null&&_18.nodeName.toLowerCase()=="img"){_15=getAttrib(_18,"class");if(_15!="mce_plugin_drupalbreak_break"){return true;}action="update";}html=""+"<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" "+" width=\"100%\" height=\"12px\" "+"alt=\"&lt;--break-&gt;\" title=\"&lt;--break--&gt;\" class=\"mce_plugin_drupalbreak_break\" />";tinyMCE.execInstanceCommand(_e,"mceInsertContent",false,html);return true;case "mcedrupalpagebreak":var _19="";var _1a=new Array();var _1b=tinyMCE.getInstanceById(_e);var _1c=_1b.getFocusElement();if(_1c!=null&&_1c.nodeName.toLowerCase()=="img"){_19=getAttrib(_1c,"class");if(_19!="mce_plugin_drupalbreak_pagebreak"){return true;}action="update";}html=""+"<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" "+" width=\"100%\" height=\"12px\" "+"alt=\"&lt;--pagebreak-&gt;\" title=\"&lt;--pagebreak--&gt;\" class=\"mce_plugin_drupalbreak_pagebreak\" />";tinyMCE.execInstanceCommand(_e,"mceInsertContent",false,html);return true;}return false;},cleanup:function(_1d,_1e){switch(_1d){case "insert_to_editor":var _1f=0;while((_1f=_1e.indexOf("<!--break-->",_1f))!=-1){var _20=_1e.substring(_1f+12);_1e=_1e.substring(0,_1f);_1e+="<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" ";_1e+=" width=\"100%\" height=\"12px\" ";_1e+="alt=\"&lt;--break-&gt;\" title=\"&lt;--break--&gt;\" class=\"mce_plugin_drupalbreak_break\" />";_1e+=_20;_1f++;}var _21=0;while((_21=_1e.indexOf("<!--pagebreak-->",_21))!=-1){var _22=_1e.substring(_21+16);_1e=_1e.substring(0,_21);_1e+="<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" ";_1e+=" width=\"100%\" height=\"12px\" ";_1e+="alt=\"&lt;--pagebreak-&gt;\" title=\"&lt;--pagebreak--&gt;\" class=\"mce_plugin_drupalbreak_pagebreak\" />";_1e+=_22;_21++;}break;case "get_from_editor":var _23=-1;while((_23=_1e.indexOf("<img",_23+1))!=-1){var _24=_1e.indexOf("/>",_23);var _25=TinyMCE_drupalbreak_parseAttributes(_1e.substring(_23+4,_24));if(_25["class"]=="mce_plugin_drupalbreak_break"){_24+=2;var _26="<!--break-->";chunkBefore=_1e.substring(0,_23);chunkAfter=_1e.substring(_24);_1e=chunkBefore+_26+chunkAfter;}if(_25["class"]=="mce_plugin_drupalbreak_pagebreak"){_24+=2;var _27="<!--pagebreak-->";chunkBefore=_1e.substring(0,_23);chunkAfter=_1e.substring(_24);_1e=chunkBefore+_27+chunkAfter;}}break;}return _1e;},handleNodeChange:function(_28,_29,_2a,_2b,_2c,_2d){function getAttrib(elm,_2f){return elm.getAttribute(_2f)?elm.getAttribute(_2f):"";}tinyMCE.switchClass(_28+"_drupalbreak_break","mceButtonNormal");tinyMCE.switchClass(_28+"_drupalbreak_pagebreak","mceButtonNormal");if(_29==null){return;}do{if(_29.nodeName.toLowerCase()=="img"&&getAttrib(_29,"class").indexOf("mce_plugin_drupalbreak_break")==0){tinyMCE.switchClass(_28+"_drupalbreak_break","mceButtonSelected");}if(_29.nodeName.toLowerCase()=="img"&&getAttrib(_29,"class").indexOf("mce_plugin_drupalbreak_pagebreak")==0){tinyMCE.switchClass(_28+"_drupalbreak_pagebreak","mceButtonSelected");}}while((_29=_29.parentNode));return true;}};tinyMCE.addPlugin("drupalbreak",TinyMCE_drupalbreakPlugin);